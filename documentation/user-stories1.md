# User Stories проекта "Схемы на сетке"

---

## Эпик 1: Фундамент + базовое рисование + UI оболочка

### US-1.1: Отображение канвы с сеткой
**Как** пользователь
**Я хочу** видеть канву с сеткой в клеточку
**Чтобы** понимать, где рисовать линии

**Критерии приёмки:**
- [ ] Канва отображается по центру экрана
- [ ] Сетка расчерчена тонкими серыми линиями
- [ ] Размер канвы по умолчанию 20x20 клеток
- [ ] Современный легкий дизайн, приятный глазу

---

### US-1.2: Нумерация и разметка
**Как** пользователь
**Я хочу** видеть номера клеток и разметку по 10
**Чтобы** ориентироваться на канве

**Критерии приёмки:**
- [ ] Номера клеток отображаются по горизонтали (сверху)
- [ ] Номера клеток отображаются по вертикали (слева)
- [ ] Нумерация начинается с 0
- [ ] Каждые 10 клеток — чуть утолщённые, но бледные линии (как на миллиметровке)

---

### US-1.3: Рисование линии кликом
**Как** пользователь
**Я хочу** ставить линию по клику левой кнопкой мыши
**Чтобы** рисовать схему

**Критерии приёмки:**
- [ ] Левый клик на границе между клетками ставит линию
- [ ] Толерантность попадания — 1/4 клетки (не нужно целиться точно)
- [ ] Линия визуально отличается от сетки (контрастнее)
- [ ] Повторный клик по той же границе не удаляет линию

---

### US-1.4: Стирание линии кликом
**Как** пользователь
**Я хочу** стирать линию по клику правой кнопкой мыши
**Чтобы** исправлять ошибки

**Критерии приёмки:**
- [ ] Правый клик на нарисованной линии удаляет её
- [ ] Правый клик на пустой границе ничего не делает
- [ ] Контекстное меню браузера не появляется

---

### US-1.5: Drag-рисование
**Как** пользователь
**Я хочу** рисовать линии, ведя мышкой с зажатой левой кнопкой
**Чтобы** быстро рисовать несколько линий подряд

**Критерии приёмки:**
- [ ] При движении с зажатой левой кнопкой линии ставятся по пути курсора
- [ ] Работает плавно без пропусков
- [ ] При горизонтальном движении не рисуются случайные вертикальные линии (и наоборот)
- [ ] Переключение направления происходит только когда курсор прошёл половину клетки в перпендикулярном направлении

---

### US-1.6: Drag-стирание
**Как** пользователь
**Я хочу** стирать линии, ведя мышкой с зажатой правой кнопкой
**Чтобы** быстро стирать несколько линий подряд

**Критерии приёмки:**
- [ ] При движении с зажатой правой кнопкой линии стираются по пути курсора
- [ ] Контекстное меню браузера не появляется
- [ ] При горизонтальном движении не стираются случайные вертикальные линии (и наоборот)
- [ ] Переключение направления происходит только когда курсор прошёл половину клетки в перпендикулярном направлении

---

### US-1.7: Боковое меню
**Как** пользователь
**Я хочу** иметь боковое меню с функциями
**Чтобы** управлять приложением

**Критерии приёмки:**
- [ ] Меню расположено слева
- [ ] Меню можно свернуть/развернуть
- [ ] В свёрнутом состоянии не мешает рисованию
- [ ] Дизайн лёгкий и современный

---

### US-1.8: Кнопка Reset
**Как** пользователь
**Я хочу** очищать канву одной кнопкой
**Чтобы** начать рисовать заново

**Критерии приёмки:**
- [ ] Кнопка Reset в боковом меню
- [ ] По нажатию все линии удаляются
- [ ] Размер канвы остаётся прежним
- [ ] Запрос подтверждения перед очисткой (опционально)

---

### US-1.9: Статистика
**Как** пользователь
**Я хочу** видеть статистику рисунка
**Чтобы** понимать его размеры

**Критерии приёмки:**
- [ ] Отображается размер канвы (например, "20×20")
- [ ] Отображается размер фигуры — ширина × высота области, занятой линиями (например, "15×18"), без координат
- [ ] Отображается количество горизонтальных линий
- [ ] Отображается количество вертикальных линий
- [ ] Статистика обновляется в реальном времени при каждом изменении (не только после перезагрузки)

---

### US-1.10: Автосохранение
**Как** пользователь
**Я хочу** чтобы моя работа сохранялась автоматически
**Чтобы** не потерять её при закрытии браузера

**Критерии приёмки:**
- [ ] Состояние сохраняется в localStorage при каждом изменении
- [ ] При открытии приложения восстанавливается последняя работа
- [ ] Сохраняются: линии, размер канвы

---

## Эпик 2: Навигация и управление канвой

### US-2.1: Масштабирование колесом мыши
**Как** пользователь
**Я хочу** масштабировать канву колесом мыши
**Чтобы** видеть детали или общую картину

**Критерии приёмки:**
- [ ] Прокрутка вверх — увеличение
- [ ] Прокрутка вниз — уменьшение
- [ ] Минимум: 8 px на клетку
- [ ] Максимум: 50 px на клетку
- [ ] Масштабирование относительно позиции курсора

---

### US-2.2: Панорамирование
**Как** пользователь
**Я хочу** перемещать канву средней кнопкой мыши
**Чтобы** просматривать разные части большой схемы

**Критерии приёмки:**
- [ ] Зажатая средняя кнопка + движение = перемещение канвы
- [ ] Курсор меняется на "grab" при панорамировании
- [ ] Работает плавно

---

### US-2.3: Изменение размера канвы (относительное)
**Как** пользователь
**Я хочу** добавлять/убавлять клетки с каждой стороны канвы
**Чтобы** расширять или сужать рабочую область

**Критерии приёмки:**
- [ ] Интерфейс в виде "креста" из инпутов (сверху, снизу, слева, справа)
- [ ] Инпуты предзаполнены числом 10
- [ ] Около каждого инпута кнопки + и -
- [ ] В центре кнопки + и - для добавления/удаления со всех сторон
- [ ] Рисунок сдвигается при добавлении сверху/слева
- [ ] Дизайн лёгкий и понятный

---

### US-2.3.1: Установка точного размера канвы
**Как** пользователь
**Я хочу** задать точный размер канвы в клетках
**Чтобы** установить нужные мне размеры

**Критерии приёмки:**
- [ ] Два инпута для ширины и высоты, предзаполненные текущими значениями
- [ ] Кнопка "Установить" для применения нового размера
- [ ] При увеличении — рисунок центрируется (добавляются клетки равномерно со всех сторон)
- [ ] При уменьшении — рисунок обрезается поровну с краёв
- [ ] Минимальный размер — 1×1

---

### US-2.4: Undo/Redo
**Как** пользователь
**Я хочу** отменять и повторять действия
**Чтобы** исправлять ошибки

**Критерии приёмки:**
- [ ] Кнопки Undo и Redo в меню
- [ ] Undo отменяет последнее действие
- [ ] Redo повторяет отменённое действие
- [ ] История сохраняется в рамках сессии

---

### US-2.5: Информер горячих клавиш
**Как** пользователь
**Я хочу** видеть список горячих клавиш
**Чтобы** быстрее работать

**Критерии приёмки:**
- [ ] Раскрывающийся блок в меню
- [ ] Содержит: Shift+click — протянуть линию
- [ ] Содержит: Ctrl+click — залить все линии в пределах границ
- [ ] Можно свернуть/развернуть

---

## Эпик 3: Продвинутое рисование

### US-3.1: Shift+клик — протягивание линии
**Как** пользователь
**Я хочу** протягивать линию до ближайшей границы через Shift+клик
**Чтобы** быстро рисовать длинные линии

**Критерии приёмки:**
- [ ] Shift + левый клик на границе
- [ ] Направление (гориз./верт.) определяется по области клика
- [ ] Линия протягивается до ближайшей закрашенной границы в этом направлении
- [ ] Если закрашенной границы нет — ничего не происходит
- [ ] Shift + правый клик пока ничего не делает

---

### US-3.2: Ctrl+клик — заливка контура
**Как** пользователь
**Я хочу** заполнять замкнутый контур линиями через Ctrl+клик
**Чтобы** быстро закрашивать области

**Критерии приёмки:**
- [ ] Ctrl + левый клик внутри контура
- [ ] Все границы внутри контура заполняются линиями (flood fill)
- [ ] Контур должен быть замкнут
- [ ] Если контур не замкнут — toast "заливка невозможна, контур не замкнут" на 2-3 секунды
- [ ] Ctrl + правый клик пока ничего не делает

---

### US-3.3: Клик по "хвостам" линий
**Как** пользователь
**Я хочу** рисовать/стирать линию на всю высоту/ширину одним кликом
**Чтобы** быстро создавать сквозные линии

**Критерии приёмки:**
- [ ] "Хвосты" — продолжения линий сетки за нумерацией, видимые на канве
- [ ] Хвосты визуально продолжаются примерно на половину клетки за областью нумерации
- [ ] Левый клик по хвосту — рисует линию на всю высоту/ширину текущим цветом
- [ ] Если линии уже существуют, они перекрашиваются в текущий цвет
- [ ] Правый клик по хвосту — стирает линию на всю высоту/ширину

---

## Эпик 4: Цвета

### US-4.1: Выбор цвета в меню
**Как** пользователь
**Я хочу** выбирать цвет для рисования
**Чтобы** создавать цветные схемы

**Критерии приёмки:**
- [ ] В меню доступно 12 цветов (палитра Google Material Design), 6 в ряд
- [ ] Белый цвет вторым после черного (дефолт для закраски клеток)
- [ ] Цвета контрастные, но приятные
- [ ] Текущий выбранный цвет выделен визуально

---

### US-4.2: Рисование цветными линиями
**Как** пользователь
**Я хочу** рисовать линии выбранным цветом
**Чтобы** различать разные части схемы

**Критерии приёмки:**
- [ ] Новые линии рисуются выбранным цветом
- [ ] Можно перекрасить существующую линию (кликнуть по ней другим цветом)

---

### US-4.3: Закраска строк/столбцов
**Как** пользователь
**Я хочу** закрашивать целые строки или столбцы клеток
**Чтобы** выделять зоны на схеме

**Критерии приёмки:**
- [ ] Левый клик на номере строки — закрашивает всю строку клеток
- [ ] Левый клик на номере столбца — закрашивает весь столбец клеток
- [ ] Закраска отображается мгновенно (не требует дополнительных действий)
- [ ] Закрашиваются клетки, не линии
- [ ] Цвет закраски — бледная версия выбранного цвета
- [ ] Линии и разметка читаются поверх закраски
- [ ] Правый клик на номере — снимает закраску (дефолтный цвет)
- [ ] Разные строки/столбцы можно закрасить разными цветами
- [ ] На пересечении закрашенных строки и столбца — последний применённый цвет

---

## Эпик 5: Экспорт и печать

### US-5.1: Выгрузка в JSON
**Как** пользователь
**Я хочу** сохранять схему в JSON файл
**Чтобы** делиться ею или создавать резервную копию

**Критерии приёмки:**
- [ ] Кнопка "Экспорт в JSON" в меню
- [ ] Скачивается файл .json
- [ ] Структура файла содержит все данные для восстановления схемы

---

### US-5.2: Загрузка из JSON
**Как** пользователь
**Я хочу** загружать схему из JSON файла
**Чтобы** продолжить работу или открыть чужую схему

**Критерии приёмки:**
- [ ] Кнопка "Загрузить из JSON" в меню
- [ ] Выбор файла через диалог
- [ ] Схема полностью восстанавливается
- [ ] При ошибке формата — понятное сообщение

---

### US-5.3: Печать в PDF
**Как** пользователь
**Я хочу** печатать схему на бумаге
**Чтобы** использовать её офлайн

**Критерии приёмки:**
- [ ] Кнопка "Печать" в меню
- [ ] Формат: А4, клетка 7 мм
- [ ] Если схема большая — автоматическая разбивка на несколько страниц
- [ ] Страницы пронумерованы для удобства склейки
- [ ] Генерируется PDF файл

---

## Сводка покрытия ТЗ

| Пункт ТЗ | User Story |
|----------|------------|
| Канва с сеткой | US-1.1 |
| Нумерация с 0 | US-1.2 |
| Разметка по 10 клеток | US-1.2 |
| Левый клик = линия | US-1.3 |
| Толерантность 1/4 клетки | US-1.3 |
| Правый клик = стирание | US-1.4 |
| Drag-рисование | US-1.5 |
| Drag-стирание | US-1.6 |
| Боковое меню | US-1.7 |
| Reset | US-1.8 |
| Статистика | US-1.9 |
| Автосохранение localStorage | US-1.10 |
| Масштабирование 8-50 px | US-2.1 |
| Масштаб относительно курсора | US-2.1 |
| Панорамирование средней кнопкой | US-2.2 |
| Изменение размера канвы | US-2.3 |
| Undo/Redo | US-2.4 |
| Информер горячих клавиш | US-2.5 |
| Shift+клик протягивание | US-3.1 |
| Ctrl+клик flood fill | US-3.2 |
| Toast при незамкнутом контуре | US-3.2 |
| Клик по хвостам линий | US-3.3 |
| Выбор цвета (8 цветов) | US-4.1 |
| Рисование цветными линиями | US-4.2 |
| Перекрашивание линий | US-4.2 |
| Закраска строк/столбцов | US-4.3 |
| Бледный цвет для клеток | US-4.3 |
| Пересечение = последний цвет | US-4.3 |
| Экспорт JSON | US-5.1 |
| Импорт JSON | US-5.2 |
| Печать PDF А4, 7 мм | US-5.3 |
| Разбивка на страницы + нумерация | US-5.3 |
| Современный лёгкий дизайн | US-1.1, US-1.7 |
| Мобильные (touch) | Отложено |
